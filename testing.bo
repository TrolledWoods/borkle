const MESSAGE = "The number is: ";

const main = fn() -> u64 {
    print(MESSAGE);
    print_i64(90);
    print("\n");

    42
};

const print = fn (buffer: [] u8) -> u64 {
    (extern "borkle_lib/hello" "put_string" : extern fn(&u8, usize) -> u64)
        (buffer.ptr, buffer.len)
};

const print_i64 = fn (num: i64) -> i64 {
    (extern "borkle_lib/hello" "print_i64" : extern fn (i64) -> i64)(num)
};

// const alloc = fn (len: usize) -> [] u8 {
//     let buf = uninit : [] u8;
//     buf.ptr = (extern "borkle_lib/hello" "alloc" : extern fn (usize) -> &u8)(len);
//     buf.len = len;
//     buf
// };
// 
// const dealloc = fn (buf: [] u8) {
//     (extern "borkle_lib/hello" "dealloc" : extern fn (&u8, usize))(buf.ptr, buf.len);
// };
// 
// const get = fn (array: &[4] &i64, index: usize) -> &&i64 {
//     let first = bit_cast array : &i64;
//     bit_cast ((index * 8) + bit_cast first)
// };

// const flush = extern "borkle_lib/hello" "flush_stdout" : extern fn();
// 
// const print_u8  = extern "borkle_lib/hello" "print_u8"  : extern fn (u8) -> u8;
// const callback  = extern "borkle_lib/hello" "callback"  : extern fn () -> extern fn (i64) -> i64;

